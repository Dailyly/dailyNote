
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>好代码/坏代码</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/default.css" id="theme">
    <link rel="stylesheet" href="css/zenburn.css">
    <style>
	.title{
		font-weight:bold;
		color:yellow;
	}
	.left{
		text-align: left;
	}
	.remark{
		font-size:20px;
	}
	</style>
</head>

<body>
<div class="reveal">

<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
<section>
    <h2>好代码/坏代码</h2>
    <p class="new-line" style="text-align:right">
        Created by <a>周昌炬</a>
    </p>
	<p class="new-line" style="text-align:right">
        2017.03.21
    </p>
</section>

<section>
<p style="text-align: left;">
    编程语言，从定义来看，其实就是一种<span class="title">语言</span>，是你和机器沟通的文字。<br/><br/>
	写代码就像写作文，文字功底的优劣，直接会影响你最终成文的质量。
	</p>
</section>


<!-----------------------------命名----------------------------->
<section>
 <h3>命名</h3>
</section>

<section>
 <h4>命名过短，不能表现其含义</h4>
 <img src="./images/name.png"/><br/>
</section>
<section>
 <h4>命名的单词很模糊，定义太空泛</h4>
 <img src="./images/name_2.png"/><br/>
</section>
<section>
 <h4>采用了一些容易产生混淆的单词</h4>
 <p class="title">BookList<br/>
 Books
 </p>
</section>
<section>
 <h4>采用了一些意义相近的单词</h4>
 <p class="title">
 add & insert<br/>
 get & fetch<br/>
 </p>
</section>
<section>
 <h4>拼错单词</h4>
 <img src="./images/name_4.png"/><br/>
</section>
<section>
 <h4>中英文混杂</h4>
 <h4>vis/application</h4>
  <p class="title">bbd<br/>
 cfxf<br/>
 chargeapp<br/>
 clxg<br/>
 financier<br/>
 freebf<br/>
 obt<br/>
 ......<br/>
 </p>
</section>



<section>
 <h3>一些命名技巧</h3>
</section>

<section>
 <h4>类/类属性都用名词或者名词短语</h4>
 <p class="title">
 Stock<br/>
 StockFilter<br/>
 Mail<br/>
 MailParser
 </p>
</section>

<section>
 <h4>方法都用动词或者动词短语</h4><br/>
 假如你写了一个名为<span class="title">Mail</span>的类，里面有如下方法：<br/>
 <p class="title">
 delete<br/>
 deleteTitle<br/>
 getBody<br/>
 </p>
 <br/>
 <p style="font-size:20px">方法的动词+类的名词，结合起来就是这个方法最终的目的；<br/>而方法的动词短语，一般都是操作这个类的某个属性，短语中的名词就是属性名</p>
</section>

<section>
 <h4>返回boolean值的方法，命名一般以is/has开头；或者以能识别状态的动词命名</h4><br/>
 <p class="title">
 isTradeDay<br/>
 hasOwnProperty<br/>
 isValid<br/>
 found<br/>
 done<br/>
 </p>
</section>

<section>
 <img src="./images/name_5.png"/><br/>
</section>


<section>
 <h4>采用识别度高/易搜索的词语命名</h4>
 It is better longer than shorter.<br/><br/>
 <p class="title">
 td => tradeDay<br/>
 sn => stockName<br/>
 </p>
</section>

<section>
 <h4>仅在短作用域中使用短命名</h4>
<p class="title" style="font-size:100px">i</p>
<img src="./images/name_3.png"/><br/>
</section>

<section>
 <h4>以问题为导向</h4>
 "what" is better than "how".<br/><br/>
 <p class="title">
 how => inputRecord<br/>
 what => employeeName<br/>
 <br/>
 how => sum<br/>
 what => totalEmployeeNumber<br/>
 </p>
</section>

<section>
 <h4>约定俗成的短语</h4>
 <p class="title">
 biz => business<br/>
 设计模式<br/>
 </p>
</section>

<section>
 <h3>重复代码-DRY</h3>
 <img src="./images/repeat_1.png"/><br/>
</section>

<section>
 <h4>重复代码的危害-霰（xiàn）弹式修改</h4><br/>
 <p  style="text-align: left;">
 1.认证中心要将认证方式从传统的account+password改为userid+sessionid方式，我们大约有<span class="title">100</span>个功能用到了该认证<br/><br/>
 2.我们有<span class="title">10</span>个产品用到了股票分时图，产品要求将分时图的颜色修改下<br/><br/>
 3.我们有大约<span class="title">40</span>台服务器上的应用用到了200.58这台行情服务器，今天行情同事反馈这台服务器挂了，应用方需要将所有用到该服务器的地方，都切换到200.5这台临时服务器<br/><br/>
 4.加班问题
 </p>
</section>

<section>
 <h3>过长的方法/类</h3>
 <a target="_blank" href="./code/过长的类_Optimal.php">代码示例1</a> <br/>
 <a target="_blank" href="./code/过长的文件.js">代码示例2</a> <br/>
<br/>
 <p class="left">
 1.难以理解<br/>
 2.设计上可能存在不合理的地方，有些内容已经超出这个类的范畴了，你很难把控(代码失控)<br/>
 3.复用性差<br/>
 4.不利于维护<br/>
 </p>
 <br/>
 <p style="font-size:20px">
  遵循单一职责，一个方法只处理一件事情
  </p>
</section>

<section>
 <h3>硬编码</h3>
  <img src="./images/hard.png"/><br/>
</section>

<section>
 <h3>参数过多</h3>
 <img src="./images/toomanyparams.png"/><br/>
</section>

<section>
 <h3>逻辑嵌套层级过深</h3>
 <a href="./code/嵌套过深.php"/>代码示例</a>
</section>

<section>
 <img src="./images/nest_1.png"/><br/>
</section>
<section>
 <img src="./images/nest_2.png"/><br/>
</section>

<section>
 <h3>过度设计</h3>
 想太多，但是想的东西又超出了自己的能力范围/需求范围。<br/><br/>
 <a href="https://www.zhihu.com/question/19993179" target="_blank">一个抽红包引发的过度设计</a>
 
</section>






<!-----------------------------结构(嵌套)----------------------------->








<!-----------------------------逻辑----------------------------->








<!-----------------------------BUG----------------------------->





<!-----------------------------异常处理与预警----------------------------->

<section>
 <h3>缺乏异常处理</h3><br/>
  <p>
 这世上有两件事情不能相信：<br/>
 一件是产品经理的需求不会变<br/>
 另外一件是其他部门提供的接口很稳定<br/><br/>
 <a>沪港通/问财项目的案例</a>
 </p>
 </section>
  <section>
 <img src="./images/exception_3.png"/><br/>
 </section>
 <section>
 <img src="./images/exception.png"/><br/>
 </section>
 <section>
 <img src="./images/exception_2.png"/><br/>
 </section>
 
 
<section>
 <h3>没有进行安全性校验</h3><br/>
 不要相信用户的任何输入；坏人不多，但一个足以致命。<br/><br/>
 <p class="title">http://172.20.1.247/train/history/exportExcel/1 and sleep(10)/</p>
 <p class="title">select * from history where id=1 and sleep(10)</p>
 <br/>
 防御式编程
</section>

<!-----------------------------自我调试----------------------------->



<!-----------------------------设计---------------------------->
<section>
 <h3>一些程序设计上的技巧</h3><br/>
</section>

<section>
 <h3>面向接口编程</h3>
 <p  style="text-align: left;">
 1.可以让你在初期理清思路<br/>
 2.先完成接口，这个时候发现问题，重构成本是很低的<br/>
 3.这里的<span class="title">接口</span>，不局限于程序中的<span class="title">interface</span>
 </p><br/>
 <a target="_blank" href="./code/面向接口编程.php">代码示例</a> <br/>
</section>

<section>
 <h3>开闭原则-OCP</h3>
 Class should be open for extension, but closed for modification.<br/><br/>
 <p class="title">
 电脑的USB接口<br/>
 Zend_Db_Adapter<br/>
 模板技术
 </p><br/>
 <a target="_blank" href="./code/开闭原则.php">代码示例</a> <br/><br/>
 <p style="font-size:20px">OCP在多人分工合作的场景，意义非常大。</p>
</section>
<section>
 <h3>测试驱动-TDD</h3>
 <p class="left">
①　快速新增一个测试<br/>
②　运行所有的测试（有时候只需要运行一个或一部分），发现新增的测试不能通过<br/>
③　做一些小小的改动，尽快地让测试程序可运行，为此可以在程序中使用一些不合情理的方法<br/>
④　运行所有的测试，并且全部通过<br/>
⑤　重构代码，以消除重复设计，优化设计结构<br/>
 </p>
 <p style="font-size:20px">简单来说，就是不可运行/可运行/重构——这正是测试驱动开发的口号。</p>
</section>
<section>
<img src="./images/tdd_1.jpg"/><br/>
<p style="font-size:20px">
盖房子的时候，工人师傅砌墙，会先用桩子拉上线，以使砖能够垒的笔直，因为垒砖的时候都是以这根线为基准的。TDD就像这样，先写测试代码，就像工人师傅先用桩子拉上线，然后编码的时候以此为基准，只编写符合这个测试的功能代码。
而一个新手或菜鸟级的小师傅，却可能不知道拉线，而是直接把砖往上垒，垒了一些之后再看是否笔直，这时候可能会用一根线，量一下砌好的墙是否笔直，如果不直再进行校正，敲敲打打。使用传统的软件开发过程就像这样，我们先编码，编码完成之后才写测试程序，以此检验已写的代码是否正确，如果有错误再一点点修改。
</p>
</section>

<section>
 <h3>及时修改，避免破窗效应</h3>
 <span class="title">@skipcs</span><br/>
  <img src="./images/pcll.jpg"/><br/>
</section>

<section>
 <h3>讨论：到底要不要写注释？</h3>
</section>
<!-----------------------------套路总结&实践----------------------------->

<!-----------------------------书籍推荐---------------------------->
<section>
 <h3>《代码大全》</h3>
 <h3>《重构-改善既有代码的设计》</h3>
</section>

<section>
<h2>谢谢</h2>
</section>
</div>
    <!-- For syntax highlighting -->
   

<script src="js/head.js"></script>
<script src="js/reveal.js"></script>

<script>
    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
            { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
    });
</script>

</body>
</html>
